---
layout: single
title: PART1.가상화 기술 - <이미지와 컨테이너>
---

이미지와 컨테이너



이미지와 컨테이너의 관계는 프로그램과 프로세스의 관계와 비슷하게 이해할 수 있다.

이미지는 프로그램이 실행되기 위한 환경이 모두 포함되어 있는 파일시스템이며 이미지를 실행한 것이 컨테이너이다.
컨테이너를 실행시키려면 해당하는 이미지를 가지고 있어야 하고 하나의 이미지로 여러개의 컨테이너 실행 가능하며 내부에서 모두
동일한 프로세스로 실행된다.

이미지는 파일의 형태로 호스트 머신의 특정 경로에 위치하며 디스크 공간만 차지하며 이미지를 컨테이너로 실행하는 순간부터
CPU와 메모리를 사용하게 된다. 
일반적인 프로세스와 차이가 있다면 컨테이너는 가상화 기술이기 때문에 이미지를 컨테이너로 실행할 때는 격리된 공간이 만들어진다.

정리하자면 이미지를 컨테이너로 실행시키는 것은 이미지에 저장되어 있는 모든 요소들을 격리된 공간으로 만든 다음에 그 안에서 프로그램을
프로세스로 실행시키는 단계를 거치는 것이다.



이미지의 메타데이터(Metadata)

이미지파일이 실제로 압축된 데이터라면, 메타데이터는 이 이미지에 대한 정보(이미지의 아이디, 이름, 사이즈 등..)를 기술하는 데이터
하나의 이미지는 실제로 압축된 파일과 이 파일의 정보가 저장되어 있는 메타데이터로 구성되어 있음
메타데이터 내용중 유심히 봐야할 것들은 env와 cmd 필드인데 우선
env는 애플리케이션이 사용하는 환경설정 값을 의미하며 Key&Value로 이루어져 있다. 소프트웨어  버전, 실행파일경로 등으로 이루어져
있으며 쉽게 말해 소프트웨어가 실행 시 참조할 설정 정보를 보관한다.

cmd는 컨테이너 실행 시 프로세스 실행 명령어를 지정한다.
이미지를 컨테이너로 실행할 때 cmd에 있는 명령어를 통해서 어떤 프로그램을 실행할 지 메타데이터에서 결정한다.
여기서 지정한 Nginx  ''이미지''의 이미지 압축파일과 ''이미지''의 메타데이터를 사용해서 격리된 공간인 컨테이너가 만들어진다.

이렇게 만들어진 컨테이너의 파일 시스템과 메타데이터는 새롭게 생성되어 격리되어 있으며 설정값을 따로 변경할 수 있다.
예를 들어, docker run --name customNginx cat usr/shard/nginx/html/index.html을 실행하면  cat 이 해당 경로의 html 을 실행하여 내부 내용을 출력하고 종료된다. 명령어를 변경한다고 해서 이미지의  cmd가 바뀌는 것은 아니다. 다시말해 이미지를 복사해오면서 실행하는 시점에서 컨테이너의 메타데이터만 변경가능하다.









